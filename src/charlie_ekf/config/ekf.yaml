ekf_node:
  ros__parameters:
    use_sim_time: true

    frequency: 30.0            # nominal EKF update rate (Hz)
    sensor_timeout: 0.2        # if no measurements arrive, still predict (s)

    frames:
      map_frame: map
      odom_frame: odom
      base_frame: base_link
      publish_tf: true

    topics:
      wheel_odom: /diffdrive_controller/odom"
      imu: "/imu"

    # Which wheel odom signals to use (from nav_msgs/Odometry.twist.twist)
    wheel_odom_use:
      v: true
      yaw_rate: true           # if your wheel odom doesn't provide it, set false

    # Which IMU signals to use (from sensor_msgs/Imu)
    imu_use:
      yaw_rate: true           # uses angular_velocity.z

    # Initial covariance (5x5) diagonal
    P0_diag: [1.0, 1.0, 0.5, 1.0, 1.0]

    # Process noise (5x5) diagonal (tune in class!)
    Q_diag:  [0.05, 0.05, 0.02, 0.50, 0.50]

    # Measurement noise (R) â€” simple diagonal terms
    R_wheel_diag: [0.20, 0.20]   # [v, yaw_rate]
    R_imu_yaw_rate: 0.05         # omega_z

